import { MongoDbClient } from "@powerkernel/mongodb-client";

import { {{DeleteEntityMongoRepo}} } from "../";

it("should delete the document from the database", async () => {
  const repo = new {{DeleteEntityMongoRepo}}();

  // start: mock
  jest.spyOn(MongoDbClient, "db", "get").mockReturnValue({
    collection: () => {
      return {
        findOneAndDelete: () => {
          return {
            value: {
              _id: MongoDbClient.createUuid(
                "f2901959-b087-4495-92a5-441d9c1efd36"
              ),
              title: "this is the title",
              createdAt: "2022-01-31T10:14:37.535Z",
              updatedAt: "2022-01-31T10:14:37.535Z",
            },
          };
        },
      };
    },
  } as never);
  // end: mock

  const id = "f2901959-b087-4495-92a5-441d9c1efd36";
  const result = await repo.remove(id);
  expect(result).toEqual({
    id: id,
    title: "this is the title",
    createdAt: "2022-01-31T10:14:37.535Z",
    updatedAt: "2022-01-31T10:14:37.535Z",
  });
});
